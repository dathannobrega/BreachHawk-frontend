# nginx.conf
server {
    listen 80;
    server_name  localhost;

    # 1) Diz que o root (build do React) está nesta pasta:
    root  /usr/share/nginx/html;
    index index.html index.htm;

    # 2) Qualquer requisição para /api/ deve ser passada como proxy (se for o seu caso).
    #    Se você já está fazendo proxy em outro container, mantenha ou configure conforme seu docker-compose.
    #    Se não, comente ou remova este bloco.
    #
    # location /api/ {
    #     proxy_pass http://backend:8000/api/;
    #     proxy_set_header Host $host;
    #     proxy_set_header X-Real-IP $remote_addr;
    #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    #     proxy_set_header X-Forwarded-Proto $scheme;
    # }

    # 3) Regra de fallback para um SPA:
    #    - Primeiro tenta servir um arquivo estático (ex: /login.js, /static/css/…).
    #    - Se não existir arquivo físico com aquele caminho, devolve /index.html (para o React Router).
    location / {
        try_files $uri $uri/ /index.html;
    }

    # 4) Opcional: trate /favicon.ico, /robots.txt, etc. como arquivos estáticos comuns:
    location = /favicon.ico        { access_log off; log_not_found off; }
    location = /robots.txt         { access_log off; log_not_found off; }

    # 5) Bloqueie acesso a logs, .git ou outras pastas sensíveis (caso deseje):
    # location ~ /\.(git|svn) {
    #     deny all;
    # }

    # 6) Proxies para WebSocket ou outras rotas podem ser adicionados aqui
}
